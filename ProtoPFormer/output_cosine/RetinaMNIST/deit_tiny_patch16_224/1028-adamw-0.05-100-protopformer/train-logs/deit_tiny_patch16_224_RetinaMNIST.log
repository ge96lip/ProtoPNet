2024-07-11 17:35:37,975 - main - INFO - Start running with args: 
Namespace(batch_size=64, distillw=0.5, enable_smoothing=False, enable_mixup=False, w_dis_token=False, base_architecture='deit_tiny_patch16_224', img_size=224, prototype_shape=[50, 192, 1, 1], prototype_activation_function='log', add_on_layers_type='regular', baseline_path=None, reserve_layers=[11], reserve_token_nums=[81], use_global=True, use_ppc_loss=True, ppc_cov_thresh=1.0, ppc_mean_thresh=2.0, global_coe=0.5, global_proto_per_class=3, ppc_cov_coe=0.1, ppc_mean_coe=0.5, data_path='./ProtoPFormer/datasets', features_lr=0.0001, add_on_layers_lr=0.003, prototype_vectors_lr=0.003, joint_lr_step_size=5, coefs_crs_ent=1, coefs_clst=0.8, coefs_sep=-0.08, coefs_l1=0.0001, epochs=100, model='deit_tiny_patch16_224', input_size=224, save_ep_freq=400, drop=0.0, drop_path=0.1, model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, opt='adamw', opt_eps=1e-08, opt_betas=None, clip_grad=None, momentum=0.9, weight_decay=0.05, sched='cosine', lr=0.0005, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, warmup_lr=0.0001, min_lr=1e-05, decay_epochs=10.0, warmup_epochs=5, cooldown_epochs=10, patience_epochs=10, decay_rate=0.1, color_jitter=0.4, aa='rand-m9-mstd0.5-inc1', smoothing=0.0, train_interpolation='bicubic', reprob=0.25, remode='pixel', recount=1, resplit=False, mixup=0.0, cutmix=1.0, cutmix_minmax=None, mixup_prob=1.0, mixup_switch_prob=0.5, mixup_mode='batch', finetune='protopformer', data_set='RetinaMNIST', inat_category='name', output_dir='./ProtoPFormer/output_cosine/RetinaMNIST/deit_tiny_patch16_224/1028-adamw-0.05-100-protopformer', device='cuda', seed=1028, resume='', start_epoch=0, eval=False, dist_eval=False, num_workers=0, pin_mem=True, world_size=1, dist_url='env://', distributed=False)
2024-07-11 17:35:37,975 - main - INFO - Distributed: False
2024-07-11 17:35:39,055 - main - INFO - Dataset num_classes: 5
2024-07-11 17:35:39,055 - main - INFO - train 1080 test: 120
2024-07-11 17:35:39,055 - main - INFO - Label smoothing is not enabled, smoothing rate: 0.0
2024-07-11 17:35:39,055 - main - INFO - Mixup is not enabled
2024-07-11 17:35:39,749 - main - INFO - number of params: 5573952
2024-07-11 17:35:39,750 - main - INFO - Start training for 100 epochs
2024-07-11 17:35:39,750 - train_one_epoch - INFO - Start train one epoch
2024-07-11 17:35:41,371 - log_every - INFO - Epoch: [0]  [ 0/16]  eta: 0:00:25  lr: 0.000100  loss: 1.6077 (1.6077)  time: 1.6200  data: 0.3159  max mem: 2436
2024-07-11 17:35:53,488 - log_every - INFO - Epoch: [0]  [15/16]  eta: 0:00:00  lr: 0.000100  loss: 1.5948 (1.5962)  time: 0.8584  data: 0.2804  max mem: 2508
2024-07-11 17:35:53,488 - log_every - INFO - Epoch: [0] Total time: 0:00:13 (0.8586 s / it)
2024-07-11 17:35:53,489 - main - INFO - Averaged stats:
2024-07-11 17:35:53,489 - main - INFO - {'lr': 0.00010000000000000003, 'loss': 1.5962295532226562}
2024-07-11 17:35:53,489 - evaluate - INFO - Start validation
2024-07-11 17:35:54,154 - log_every - INFO - Test:  [0/2]  eta: 0:00:01  loss: 1.5797 (1.5797)  acc1: 45.8333 (45.8333)  acc5: 100.0000 (100.0000)  global_acc1: 45.8333 (45.8333)  local_acc1: 45.8333 (45.8333)  time: 0.6632  data: 0.3091  max mem: 2508
2024-07-11 17:35:54,409 - log_every - INFO - Test:  [1/2]  eta: 0:00:00  loss: 1.5797 (1.5821)  acc1: 41.6667 (45.0000)  acc5: 100.0000 (100.0000)  global_acc1: 41.6667 (45.0000)  local_acc1: 41.6667 (45.0000)  time: 0.4585  data: 0.1939  max mem: 2508
2024-07-11 17:35:54,409 - log_every - INFO - Test: Total time: 0:00:00 (0.4596 s / it)
2024-07-11 17:35:54,409 - evaluate - INFO - * Acc@1 45.000 Acc@5 100.000 loss 1.582
2024-07-11 17:35:54,410 - main - INFO - {'loss': 1.5821024179458618, 'acc1': 45.00000228881836, 'acc5': 100.0, 'global_acc1': 45.00000228881836, 'local_acc1': 45.00000228881836}
2024-07-11 17:35:54,410 - main - INFO - Accuracy of the network on the 120 test images: 45.0%
2024-07-11 17:35:54,858 - main - INFO - Max accuracy: 45.00%
2024-07-11 17:35:54,858 - main - INFO - {'train_lr': 0.00010000000000000003, 'train_loss': 1.5962295532226562, 'test_loss': 1.5821024179458618, 'test_acc1': 45.00000228881836, 'test_acc5': 100.0, 'test_global_acc1': 45.00000228881836, 'test_local_acc1': 45.00000228881836, 'epoch': 0, 'n_parameters': 5573952}
2024-07-11 17:35:54,860 - train_one_epoch - INFO - Start train one epoch
2024-07-11 17:35:55,660 - log_every - INFO - Epoch: [1]  [ 0/16]  eta: 0:00:12  lr: 0.000100  loss: 1.5735 (1.5735)  time: 0.7985  data: 0.3102  max mem: 2508
2024-07-11 17:36:07,781 - log_every - INFO - Epoch: [1]  [15/16]  eta: 0:00:00  lr: 0.000100  loss: 1.5722 (1.5703)  time: 0.8074  data: 0.2892  max mem: 2508
2024-07-11 17:36:07,781 - log_every - INFO - Epoch: [1] Total time: 0:00:12 (0.8076 s / it)
2024-07-11 17:36:07,784 - main - INFO - Averaged stats:
2024-07-11 17:36:07,785 - main - INFO - {'lr': 0.00010000000000000003, 'loss': 1.5703258514404297}
2024-07-11 17:36:07,785 - evaluate - INFO - Start validation
2024-07-11 17:36:08,445 - log_every - INFO - Test:  [0/2]  eta: 0:00:01  loss: 1.5344 (1.5344)  acc1: 45.8333 (45.8333)  acc5: 100.0000 (100.0000)  global_acc1: 45.8333 (45.8333)  local_acc1: 45.8333 (45.8333)  time: 0.6580  data: 0.3081  max mem: 2508
2024-07-11 17:36:08,658 - log_every - INFO - Test:  [1/2]  eta: 0:00:00  loss: 1.5344 (1.5408)  acc1: 41.6667 (45.0000)  acc5: 100.0000 (100.0000)  global_acc1: 41.6667 (45.0000)  local_acc1: 41.6667 (45.0000)  time: 0.4351  data: 0.1893  max mem: 2508
2024-07-11 17:36:08,658 - log_every - INFO - Test: Total time: 0:00:00 (0.4363 s / it)
2024-07-11 17:36:08,658 - evaluate - INFO - * Acc@1 45.000 Acc@5 100.000 loss 1.541
2024-07-11 17:36:08,658 - main - INFO - {'loss': 1.5407816767692566, 'acc1': 45.00000228881836, 'acc5': 100.0, 'global_acc1': 45.00000228881836, 'local_acc1': 45.00000228881836}
2024-07-11 17:36:08,659 - main - INFO - Accuracy of the network on the 120 test images: 45.0%
2024-07-11 17:36:08,659 - main - INFO - Max accuracy: 45.00%
2024-07-11 17:36:08,659 - main - INFO - {'train_lr': 0.00010000000000000003, 'train_loss': 1.5703258514404297, 'test_loss': 1.5407816767692566, 'test_acc1': 45.00000228881836, 'test_acc5': 100.0, 'test_global_acc1': 45.00000228881836, 'test_local_acc1': 45.00000228881836, 'epoch': 1, 'n_parameters': 5573952}
2024-07-11 17:36:08,660 - train_one_epoch - INFO - Start train one epoch
2024-07-11 17:36:09,469 - log_every - INFO - Epoch: [2]  [ 0/16]  eta: 0:00:12  lr: 0.000100  loss: 1.5485 (1.5485)  time: 0.8073  data: 0.2797  max mem: 2508
2024-07-11 17:36:21,690 - log_every - INFO - Epoch: [2]  [15/16]  eta: 0:00:00  lr: 0.000100  loss: 1.4944 (1.4936)  time: 0.8142  data: 0.2922  max mem: 2508
2024-07-11 17:36:21,691 - log_every - INFO - Epoch: [2] Total time: 0:00:13 (0.8144 s / it)
2024-07-11 17:36:21,691 - main - INFO - Averaged stats:
2024-07-11 17:36:21,692 - main - INFO - {'lr': 0.00010000000000000003, 'loss': 1.493638038635254}
2024-07-11 17:36:21,692 - evaluate - INFO - Start validation
2024-07-11 17:36:22,295 - log_every - INFO - Test:  [0/2]  eta: 0:00:01  loss: 1.3847 (1.3847)  acc1: 45.8333 (45.8333)  acc5: 100.0000 (100.0000)  global_acc1: 45.8333 (45.8333)  local_acc1: 45.8333 (45.8333)  time: 0.6014  data: 0.2843  max mem: 2508
2024-07-11 17:36:22,532 - log_every - INFO - Test:  [1/2]  eta: 0:00:00  loss: 1.3847 (1.4081)  acc1: 41.6667 (45.0000)  acc5: 100.0000 (100.0000)  global_acc1: 41.6667 (45.0000)  local_acc1: 41.6667 (45.0000)  time: 0.4186  data: 0.1808  max mem: 2508
2024-07-11 17:36:22,532 - log_every - INFO - Test: Total time: 0:00:00 (0.4199 s / it)
2024-07-11 17:36:22,532 - evaluate - INFO - * Acc@1 45.000 Acc@5 100.000 loss 1.408
2024-07-11 17:36:22,533 - main - INFO - {'loss': 1.408086121082306, 'acc1': 45.00000228881836, 'acc5': 100.0, 'global_acc1': 45.00000228881836, 'local_acc1': 45.00000228881836}
2024-07-11 17:36:22,533 - main - INFO - Accuracy of the network on the 120 test images: 45.0%
2024-07-11 17:36:22,534 - main - INFO - Max accuracy: 45.00%
2024-07-11 17:36:22,534 - main - INFO - {'train_lr': 0.00010000000000000003, 'train_loss': 1.493638038635254, 'test_loss': 1.408086121082306, 'test_acc1': 45.00000228881836, 'test_acc5': 100.0, 'test_global_acc1': 45.00000228881836, 'test_local_acc1': 45.00000228881836, 'epoch': 2, 'n_parameters': 5573952}
2024-07-11 17:36:22,535 - train_one_epoch - INFO - Start train one epoch
2024-07-11 17:36:23,330 - log_every - INFO - Epoch: [3]  [ 0/16]  eta: 0:00:12  lr: 0.000100  loss: 1.4188 (1.4188)  time: 0.7941  data: 0.3357  max mem: 2508
